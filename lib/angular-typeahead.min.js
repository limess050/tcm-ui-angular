angular.module("siyfion.sfTypeahead",[]).directive("sfTypeahead",function(){return{restrict:"ACE",scope:{datasets:"=",ngModel:"="},link:function(a,b){b.typeahead(a.datasets),b.bind("typeahead:selected",function(b,c,d){a.$apply(function(){a.ngModel=c,a.selectedDataset=d})}),b.bind("typeahead:autocompleted",function(b,c,d){a.$apply(function(){a.ngModel=c,a.selectedDataset=d})}),a.$watch("ngModel",function(c){if($.isArray(a.datasets)){for(var d=0;d<a.datasets.length;d++)if(a.datasets[d].name==a.selectedDataset){var e=a.datasets[d].valueKey;break}}else var e=a.datasets.valueKey;c&&e&&c.hasOwnProperty(e)&&(c=c[e]),b.typeahead("setQuery",c||"")})}}});